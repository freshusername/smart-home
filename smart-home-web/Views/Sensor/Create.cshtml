@using smart_home_web.Models.SensorViewModel
@model CreateSensorViewModel
@{
    @*<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">*@

    <div class="container">

        <h2>Add new sensor</h2>
        <hr />

        <div class="row">
            <div class="col-md-4">
                <form asp-antiforgery="true" asp-action="AddSensor" asp-controller="Sensor" method="post" enctype="multipart/form-data">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                    <div class="form-group">
                        <label asp-for="@Model.Name" class="control-label"></label>
                        <input asp-for="@Model.Name" class="form-control" placeholder="Enter name please" />
                        <span asp-validation-for="Name" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="@Model.Comment" class="control-label"></label>
                        <input asp-for="@Model.Comment" class="form-control" placeholder="Enter comment please" />
                        <span asp-validation-for="Comment" class="text-danger"></span>
                    </div>

                    <input hidden asp-for="@Model.Token" value="@Guid.NewGuid()" />
                    <input hidden asp-for="@Model.CreatedOn" value="@DateTimeOffset.Now" />

                    <div class="form-group">
                        <select asp-for="@Model.SensorTypeId" class="suit-select">
                            <option value="@String.Empty">Select type</option>
                            @foreach (var sensortType in ViewBag.SensorTypes)
                            {
                                <option value="@sensortType.Id">@sensortType.Name</option>
                            }
                        </select>
                    </div>

                    <div class="form-group">
                        <label asp-for="@Model.IsActivated" class="control-label">Activate</label>
                        <input asp-for="@Model.IsActivated" type="checkbox" data-toggle="toggle" data-on="Activated" data-off="Disabled">
                    </div>

                    <div class="form-group">
                        <div class="row">
                            <p>Upload sensor icon: </p>
                            <input asp-for="@Model.IconFile" onchange="loadFile(event)" type="file" accept=".jpg, .jpeg, .png" />
                            <img src="" id="output" width="64" height="64" style="visibility: hidden" />
                        </div>
                    </div>

                    <div class="form-group">
                        <input type="submit" value="AddSensor" class="btn btn-success" />
                        <a class="btn btn-primary" asp-action="Index"><em class="glyphicon glyphicon-arrow-left"></em> Back to List</a>
                    </div>

                </form>
            </div>
        </div>
    </div>
}

@*<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>*@

<script>
    var loadFile = function (event) {
        var reader = new FileReader();
        reader.onload = function () {
            var output = document.getElementById('output');
            output.src = reader.result;
            output.style.visibility = "visible";
        };
        reader.readAsDataURL(event.target.files[0]);
    };
</script>

@section scripts{

    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
}